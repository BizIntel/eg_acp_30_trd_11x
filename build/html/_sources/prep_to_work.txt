Подготовка продукта к работе
============================

.. _описание_поставки:

Описание файла поставки продукта
--------------------------------

Обычно продукт версии ПРОФ, поставляется в виде zip-архива, наименование которого соответствует шаблону

**pt_cid_cen_en_rln**, где 

* :abbr:`pt(product type)` - тип продукта, например eg - "Модуль 1С-ЕГАИС";
* :abbr:`cid(configuration id)` - идентификатор конфигурации, например "acc" - "1С:Бухгалтерия предприятия", "trd" - "1С:Управление торговлей 8". Последний,3-й символ, в значении **"p"** означает, что продукт является версией ПРОФ, в остальных случаях поставка является базовой версией продукта;
* :abbr:`cen(configuration edition number)` - редакция конфигурации, например 3.0, 11.1 и т.д.
* :abbr:`en(edition number)` - редакция продукта "Модуль 1С:ЕГАИС";
* :abbr:`rln(release number)` - номер релиза продукта "Модуль 1С-ЕГАИС"

**Примеры:**

**eg_trp_111_10.111** - продукт *Модуль 1С-ЕГАИС*, версия продукта *ПРОФ*, предназначен для конфигурации *1С:УТ 8 , ред. 11.1*, ред. модуля 1.0, релиз № 111 

**eg_acс_30_10.111** - Модуль 1С-ЕГАИС базовая версия для конфигурация 1С:БП, ред 3.0, ред. модуля 1.0 


Комплектация поставки
---------------------
Комплектация содержит:

#. Дополнение конфигурации 1С, в виде файла с расширением ``*.cf``, например ``1cv8.cf``
#. Инструкция по установке продукта.
#. Дополнительные обработки для перехода с более ранних версий продукта на версию текущей поставки. 

Внедрение модуля 1С-ЕГАИС в рабочую информационную базу 1C
-----------------------------------------------------------

.. danger:: Перед началом процедуры объединения конфигураций необходимо сделать резервную копию рабочей информационной базы!

Откройте вашу рабочую базу в режиме Конфигуратор». Зайдите в меню ``Конфигурация`` и выберите ``Открыть 
конфигурацию»``. Если конфигурация уже открыта, пункт ``Открыть конфигурацию»`` будет недоступен и можно сразу 
переходить к следующему шагу.

Зайдите в меню ``Конфигурация`` и выберите ``Поддержка``, затем ``Настройка поддержки``. В открывшемся окне нажмите 
кнопку ``Включить возможность изменения``

.. figure:: _static/install01.png

После некоторого времени, которое потребуется на включение возможности изменения окно настройки поддержки 
примет вид как на рисунке ниже. Возможет также вариант, что у вас уже включена возможность изменения 
конфигурации, тогда окно уже будет иметь нужный вид.

.. figure:: _static/install02.png

После того, как возможность изменений включена, вам необходимо добавить возможность редактирования для корня 
конфигурации. Если ранее не было изменений конфигурации, разрешать редактирование для подчиненных объектов не 
обязательно.

Далее необходимо зайти в меню ``Конфигурация`` и выбрать ``Сравнить, объединить с конфигурацией из файла…`` 
Нужный файл (**1cv8.cf**) находится в том каталоге, в который Вы распаковали файл поставки. Подробнее смотрите параграф :ref:`описание_поставки`.

После выбора файла с конфигурацией модуля 1С-ЕГАИС нужно будет указать, что конфигурация, содержащаяся в файле должна быть поставлена на поддержку.

.. figure:: _static/install03.png

После нажатия кнопки ``Да`` откроется окно сравнения конфигураций.

.. important:: Обязательно нужно снять галочку с пункта «Свойства», как показано на рисунке ниже

.. figure:: _static/install04.png

В следующем окне откроются настройки правил поддержки, их нужно оставить так, как установлено по умолчанию и 
нажать ``Ок``

.. figure:: _static/install05.png

После нажатия на кнопку ``Ок`` произойдет объединения конфигураций. Как только оно будет окончено, платформа об 
этом сообщит:

.. figure:: _static/install06.png

После объединения конфигураций, необходимо сохранить изменения в конфигурацию инф. базы. Для этого нужно 
нажать на кнопку ``Обновить конфигурацию базы данных``, как показано на рисунке ниже. Затем, после реструктуризации 
данных, нужно принять изменения.

.. figure:: _static/install07.png

После принятия изменений, необходимо зайти в меню ``Сервис``, затем ``Параметры`` и перейти на закладку ``Запуск 
1С:Предприятия``. В параметр запуска необходимо написать следующее: ``ЗапуститьОбновлениеИнформационнойБазы``

.. figure:: _static/install08.png

После сохранения параметров по кнопке ``Ок``, необходимо запустить 1С:Предприятие в режиме пользователя с 
установленным параметром запуска. Для этого в Конфигураторе нажмите на клавиатуре ``F5``. Запуститься ваша рабочая 
база в обычном режиме и начнется процедура обновления информационной базы.

.. figure:: _static/install09.png

После завершения процедуры, закройте вашу информационную базу и вернитесь в конфигуратор. Зайдите в меню 
``Сервис``, затем ``Параметры`` и перейдите на закладку ``Запуск 1С:Предприятия``. В параметре запуска удалите все, что 
там написано, чтобы поле параметр запуска было пустое. Сохраните параметры по кнопке ``Ок``.

.. figure:: _static/install10.png

Последнее, что осталось сделать – снять с поддержки корень конфигурации для поставщика Бизнес-Интеллект. Для этого 
зайдите в меню ``Конфигурация``и выберите ``Поддержка``, затем ``Настройка поддержки``. В поле ``Конфигурация 
поставщика`` выберите ЕГАИС_ПРОФ_БИТ, затем укажите, что корень конфигурации снят с поддержки, как показано на 
рисунке ниже.

.. figure:: _static/install11.png

На этом установка модуля 1С-ЕГАИС опт (ПРОФ) закончена.

Начальные настрока программы
----------------------------

Модуль 1С-ЕГАИС ПРОФ реализован в виде отдельной подсистемы с наименованием "Модуль 1С-ЕГАИС".

Интерфейс подсистемы выглядит так:

.. figure:: _static/set_up01.png

Начинать настройку модуля следует с настроек обмена с ЕГАИС так как именно эти настройки определяют параметры взаимодействия с этой системой.

Тажке эти настроки необходимы для активации продукта (см. раздел "Активация модуля 1С-ЕГАИС").

Для того чтобы перейти к настройкам в разделе "ТТН ЕГАИС" найдите и выполните команду ``Настройки обмена с ЕГАИС`` (см. рис. выше). В

В разделе **"Настройки обмена с ЕГАИС"** нажмите кнопку ``Добавить``. Эта команда вызывает окно заполнения настроек.

.. figure:: _static/set_up02.png

В окне заполнения настроек необходимо заполнить несколько параметров настроек.

.. figure:: _static/set_up03.png

* Организация - организация информационной базы (та что находится в справочнике ``Организации``), соответствующая организации ЕГАИС. 
* Склад - элемент справочника ``Склады``, в модуле 1С-ЕГАИС используется для формирования разреза учета по обособленным подразделениям
* Организация ЕГАИС - специальный справочник, содержащий сведения об организации, зарегистрированной в ЕГАИС. Подробнее см. в разделе :ref:`организации_егаис`.
* Адрес :abbr:`УТМ(Универсальный транспортный модуль)` - ip-адрес :abbr:`УТМ(Универсальный транспортный модуль)`, например 192.168.1.205, 127.0.0.1 или localhost, в случае если УТМ и 1С установлены на одном и том же компьютере.  
* Порт УТМ
* Версия формата(начиная с релиза 1.0.103) - здесь необходимо указать версию формата обмена с ЕГАИС. Например при работе с ситемой до 01.07.2017 используется версия формата обмена "01", а после "02" (требуется уточнение версии формата на момент настроки, это можно сделать на сайте ФСРАР)
* Использование(начиная с версии 1.0.102) - признак использования или активности настройки. Если флажок установлен, значит настройка используется, в противном случае - не используется. Это удобно в случае, когда настройку необходимо временно отключить, не прибегая к более радикальной мере - удалению настройки. 

После заполнения всех полей настроек необходимо их записать (команда ``Записать и закрыть``)

.. figure:: _static/set_up04.png

Настройка обмена с ЕГАИС завершена, но для того чтобы модуль мог взаимодействовать с ЕГАИС продукт необходимо активировать.

.. _активация_модуля:

Для этого существует 

Активация модуля 1С-ЕГАИС
-------------------------

При первом запуске модуля, его необходимо активировать в центре лицензирования. В противном случае работа с модулем невозможна т.е. взаимодействие с ЕГАИС осуществляться не будет.

.. warning:: Любые действия, направленные на обход системы лицензирования продукта "Модуль 1С-ЕГАИС" нарушают авторские права правообладателя, со всеми вытекающими последствиями нарушения законодательства об авторском праве

.. note:: Активацию модуля необходимо производить для каждого **транспортного модуля** и каждого **обособленного подразделения** от имени которого будет осуществляться взаимодействие с ЕГАИС. Таким образом, при активации, лицензия "привязывается" к каждому идентификатору ФСРАР.





  
































